"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _chronoNode=require("chrono-node"),_chronoNode2=_interopRequireDefault(_chronoNode),_path=require("path"),_path2=_interopRequireDefault(_path),_fs=require("fs"),_fs2=_interopRequireDefault(_fs);function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var determineYear=function(e,t){return void 0===t[1]?new Date(e).getFullYear():parseInt(t[1])},determineDate=function(e,t){if("abs"===t.type)return t.date;if(0<t.nth){var r=new Date(Date.UTC(e,t.month-1,1,0,1,0,0));return(t.day-r.getUTCDay()+7)%7+7*(t.nth-1)+1}var n=new Date(Date.UTC(e,t.month,0,0,1,0,0));return n.getUTCDate()-(n.getUTCDay()-t.day+7)%7+7*(t.nth+1)},regexFromName=function(e){return e.replace(/ /g,"(\\s+)").replace(/\(/g,"(?:")+"(?:\\s+(?:in\\s+)?(\\d+))?"},HolidayChrono=function(e){function i(){var e,t,r;_classCallCheck(this,i);for(var n=arguments.length,o=Array(n),a=0;a<n;a++)o[a]=arguments[a];return(t=r=_possibleConstructorReturn(this,(e=i.__proto__||Object.getPrototypeOf(i)).call.apply(e,[this].concat(o)))).addHoliday=function(i){var u=new _chronoNode2.default.Parser;u.pattern=function(){return new RegExp(regexFromName(i.name),"i")},u.extract=function(e,t,r,n){var o=determineYear(t,r),a=determineDate(o,i);return new _chronoNode2.default.ParsedResult({ref:t,pattern:u.pattern(),text:r[0],index:r.index,start:{year:o,month:i.month,day:a}})},r.parsers.push(u)},r.configure=function(){_fs2.default.readdirSync(_path2.default.resolve(__dirname,"holidays")).forEach(function(e){var t=_path2.default.resolve(__dirname,"holidays",e);JSON.parse(_fs2.default.readFileSync(t,"utf8")).forEach(function(e){r.addHoliday(e)})})},_possibleConstructorReturn(r,t)}return _inherits(i,_chronoNode2.default.Chrono),i}();exports.default=HolidayChrono;